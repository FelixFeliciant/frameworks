<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>dojox.gfx &mdash; Dojo Toolkit v1.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="Dojo Toolkit v1.3.0 documentation" href="../index.html" />
    <link rel="up" title="DojoX" href="contents.html" />
    <link rel="next" title="dojox.gfx.matrix" href="gfx-geometric-properties.html" />
    <link rel="prev" title="dojo.fx.wipeIn" href="fx/wipeTo.html" />
<script type="text/javascript">
	var djConfig = {
		parseOnLoad:true, 
		isDebug: false
	}
</script>
<script type="text/javascript" src="../_static/dojo/dojo/dojo.js"></script>
<style type="text/css">
@import "../_static/dojo/dijit/themes/dijit.css";
@import "../_static/dojo/dijit/themes/nihilo/nihilo.css";
@import "../_static/dojo/docs/widget/resources/CodeViewer.css";
@import "../_static/css/layout.css";
</style>

  </head>
  <body>  

    <div class="document">
	<div id="container">
      <div id="header">
	<div class="container">
		<div id="navHeader">
		  <ul>
		    <li><a href="../index.html">home</a> |</li>
            <li style="margin-right: 10px">
		      <a href="gfx-geometric-properties.html" title="dojox.gfx.matrix"
			 accesskey="N">next</a></li>
            <li >
		      <a href="fx/wipeTo.html" title="dojo.fx.wipeIn"
			 accesskey="P">previous</a> |</li>
		    <li><a href="../contents.html">Dojo Toolkit v1.3.0 documentation</a> &raquo;</li>
		      <li><a href="contents.html" accesskey="U">DojoX</a> &raquo;</li> 
		  </ul>
		</div>
		<div id="searchHeader">
		    <div class="searchContainer">
		        <form class="search" action="../search.html" method="get">
                    <input class="textInput" type="text" name="q" size="18" />
                    <input class="buttonInput" type="submit" value="Go" />
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                </form>
		    </div>
		</div>
	</div>
      </div>
      <div class="content">
	<div id="content">
		  <div id="contentRight">
			  
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../contents.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference" href="">dojox.gfx</a><ul>
<li><a class="reference" href="#overview">Overview</a><ul>
<li><a class="reference" href="#renderer-options">Renderer Options</a></li>
<li><a class="reference" href="#core-concepts">Core Concepts</a></li>
<li><a class="reference" href="#groups">Groups</a></li>
</ul>
</li>
<li><a class="reference" href="#shape-properties-colors-strokes-fills-fonts">Shape Properties: Colors, Strokes, Fills &amp; Fonts</a><ul>
<li><a class="reference" href="#color">Color</a></li>
<li><a class="reference" href="#stroke-property">Stroke property</a></li>
<li><a class="reference" href="#fill-property">Fill property</a><ul>
<li><a class="reference" href="#implementation-details">Implementation details</a></li>
</ul>
</li>
<li><a class="reference" href="#font-property">Font property</a><ul>
<li><a class="reference" href="#implementation-notes">Implementation notes</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference" href="#coordinates-and-transformations">Coordinates and Transformations</a><ul>
<li><a class="reference" href="#simple-examples">Simple examples</a></li>
<li><a class="reference" href="#more-complex-examples">More complex examples</a></li>
<li><a class="reference" href="#combining-transformation-matrices">Combining Transformation Matrices</a></li>
<li><a class="reference" href="#transformation-constants">Transformation Constants</a></li>
<li><a class="reference" href="#matrix-creation">Matrix Creation</a></li>
<li><a class="reference" href="#useful-matrix-operations">Useful Matrix Operations</a><ul>
<li><a class="reference" href="#examples">Examples</a></li>
<li><a class="reference" href="#more-complex-example">More complex example</a></li>
</ul>
</li>
<li><a class="reference" href="#transformations-around-a-point">Transformations Around a Point</a></li>
</ul>
</li>
<li><a class="reference" href="#common-shape-methods">Common Shape Methods</a><ul>
<li><a class="reference" href="#event-processing">Event processing</a><ul>
<li><a class="reference" href="#id2">Implementation notes</a></li>
</ul>
</li>
<li><a class="reference" href="#helper-methods">Helper Methods</a></li>
</ul>
</li>
<li><a class="reference" href="#individual-graphics-objects">Individual graphics objects</a><ul>
<li><a class="reference" href="#surface">Surface</a></li>
<li><a class="reference" href="#group">Group</a></li>
<li><a class="reference" href="#rectangle">Rectangle</a></li>
<li><a class="reference" href="#circle">Circle</a></li>
<li><a class="reference" href="#ellipse">Ellipse</a></li>
<li><a class="reference" href="#line">Line</a></li>
<li><a class="reference" href="#polyline">Polyline</a></li>
<li><a class="reference" href="#path">Path</a><ul>
<li><a class="reference" href="#id3">Examples</a></li>
</ul>
</li>
<li><a class="reference" href="#image">Image</a></li>
<li><a class="reference" href="#text">Text</a><ul>
<li><a class="reference" href="#id4">Implementation notes</a></li>
</ul>
</li>
<li><a class="reference" href="#textpath">TextPath</a><ul>
<li><a class="reference" href="#id5">Implementation notes</a></li>
<li><a class="reference" href="#alignment">Alignment</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference" href="#utilities">Utilities</a><ul>
<li><a class="reference" href="#move-js">move.js</a></li>
<li><a class="reference" href="#utils-js">utils.js</a></li>
<li><a class="reference" href="#decompose-js">decompose.js</a></li>
<li><a class="reference" href="#arc-js">arc.js</a></li>
</ul>
</li>
<li><a class="reference" href="#considerations-and-caveats">Considerations and Caveats</a></li>
<li><a class="reference" href="#demos">Demos</a></li>
<li><a class="reference" href="#tests">Tests</a></li>
<li><a class="reference" href="#todo">TODO</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="fx/wipeTo.html"
                                  title="previous chapter">dojo.fx.wipeIn</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="gfx-geometric-properties.html"
                                  title="next chapter">dojox.gfx.matrix</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/dojox/gfx.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
        </div>
      </div>
		  </div>
		  <div id="contentLeft">
		    <div class="bodywrapper">
		      <div class="body">
			
  <div class="section" id="dojox-gfx">
<span id="id1"></span><h1><a class="toc-backref" href="#id6">dojox.gfx<a class="headerlink" href="#dojox-gfx" title="Permalink to this headline">Â¶</a></a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Draft</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">beta</td>
</tr>
<tr class="field"><th class="field-name">Authors:</th><td class="field-body">Eugene Lazutkin, Kun Xi, Chris Mitchell</td>
</tr>
</tbody>
</table>
<div class="contents topic">
<p class="topic-title first"><a id="contents" name="contents">Contents</a></p>
<ul class="simple">
<li><a class="reference" href="#dojox-gfx" id="id6" name="id6">dojox.gfx</a><ul>
<li><a class="reference" href="#overview" id="id7" name="id7">Overview</a><ul>
<li><a class="reference" href="#renderer-options" id="id8" name="id8">Renderer Options</a></li>
<li><a class="reference" href="#core-concepts" id="id9" name="id9">Core Concepts</a></li>
<li><a class="reference" href="#groups" id="id10" name="id10">Groups</a></li>
</ul>
</li>
<li><a class="reference" href="#shape-properties-colors-strokes-fills-fonts" id="id11" name="id11">Shape Properties: Colors, Strokes, Fills &amp; Fonts</a><ul>
<li><a class="reference" href="#color" id="id12" name="id12">Color</a></li>
<li><a class="reference" href="#stroke-property" id="id13" name="id13">Stroke property</a></li>
<li><a class="reference" href="#fill-property" id="id14" name="id14">Fill property</a></li>
<li><a class="reference" href="#font-property" id="id15" name="id15">Font property</a></li>
</ul>
</li>
<li><a class="reference" href="#coordinates-and-transformations" id="id16" name="id16">Coordinates and Transformations</a><ul>
<li><a class="reference" href="#simple-examples" id="id17" name="id17">Simple examples</a></li>
<li><a class="reference" href="#more-complex-examples" id="id18" name="id18">More complex examples</a></li>
<li><a class="reference" href="#combining-transformation-matrices" id="id19" name="id19">Combining Transformation Matrices</a></li>
<li><a class="reference" href="#transformation-constants" id="id20" name="id20">Transformation Constants</a></li>
<li><a class="reference" href="#matrix-creation" id="id21" name="id21">Matrix Creation</a></li>
<li><a class="reference" href="#useful-matrix-operations" id="id22" name="id22">Useful Matrix Operations</a></li>
<li><a class="reference" href="#transformations-around-a-point" id="id23" name="id23">Transformations Around a Point</a></li>
</ul>
</li>
<li><a class="reference" href="#common-shape-methods" id="id24" name="id24">Common Shape Methods</a><ul>
<li><a class="reference" href="#event-processing" id="id25" name="id25">Event processing</a></li>
<li><a class="reference" href="#helper-methods" id="id26" name="id26">Helper Methods</a></li>
</ul>
</li>
<li><a class="reference" href="#individual-graphics-objects" id="id27" name="id27">Individual graphics objects</a><ul>
<li><a class="reference" href="#surface" id="id28" name="id28">Surface</a></li>
<li><a class="reference" href="#group" id="id29" name="id29">Group</a></li>
<li><a class="reference" href="#rectangle" id="id30" name="id30">Rectangle</a></li>
<li><a class="reference" href="#circle" id="id31" name="id31">Circle</a></li>
<li><a class="reference" href="#ellipse" id="id32" name="id32">Ellipse</a></li>
<li><a class="reference" href="#line" id="id33" name="id33">Line</a></li>
<li><a class="reference" href="#polyline" id="id34" name="id34">Polyline</a></li>
<li><a class="reference" href="#path" id="id35" name="id35">Path</a></li>
<li><a class="reference" href="#image" id="id36" name="id36">Image</a></li>
<li><a class="reference" href="#text" id="id37" name="id37">Text</a></li>
<li><a class="reference" href="#textpath" id="id38" name="id38">TextPath</a></li>
</ul>
</li>
<li><a class="reference" href="#utilities" id="id39" name="id39">Utilities</a><ul>
<li><a class="reference" href="#move-js" id="id40" name="id40">move.js</a></li>
<li><a class="reference" href="#utils-js" id="id41" name="id41">utils.js</a></li>
<li><a class="reference" href="#decompose-js" id="id42" name="id42">decompose.js</a></li>
<li><a class="reference" href="#arc-js" id="id43" name="id43">arc.js</a></li>
</ul>
</li>
<li><a class="reference" href="#considerations-and-caveats" id="id44" name="id44">Considerations and Caveats</a></li>
<li><a class="reference" href="#demos" id="id45" name="id45">Demos</a></li>
<li><a class="reference" href="#tests" id="id46" name="id46">Tests</a></li>
<li><a class="reference" href="#todo" id="id47" name="id47">TODO</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id7">Overview<a class="headerlink" href="#overview" title="Permalink to this headline">Â¶</a></a></h2>
<p>dojox.gfx (GFX) is a cross-platform vector graphics API. It loosely follows SVG as the underlying model. GFX helps to isolate your application from the many native vector graphics implementation differences across all modern Browsers. It does this by detecting the best graphics engine implementation for the Browser that the application is running on, and providing api&#8217;s that are the same across the various implementations. By using the GFX api&#8217;s, your application can use a set of api&#8217;s that don&#8217;t lock you into any one particular browser (or plugin&#8217;s) implementation of vector graphics.</p>
<div class="section" id="renderer-options">
<h3><a class="toc-backref" href="#id8">Renderer Options<a class="headerlink" href="#renderer-options" title="Permalink to this headline">Â¶</a></a></h3>
<p>As of Dojo 1.2, the following native vector graphics engine adaptations are implemented:</p>
<ul class="simple">
<li>SVG (Firefox 1.5-3.0, Safari(Webkit) 3.0, Opera 9.0, Chrome 1.0(Webkit) (beta), iPhone Safari 2.1)</li>
<li>VML (IE 6-7)</li>
<li>Silverlight (wherever it is supported by Microsoft)</li>
<li>Canvas (Firefox 2.0-3.0, Safari 3.0 including iPhone Safari 1.x &amp; 2.x, Opera 9.0)</li>
</ul>
<p>Other renderer adaptations&#8217;s could be implemented as well underneath these api&#8217;s. For example, a Flash player implementation can be built that plugs in under the GFX api&#8217;s (perhaps using dojox.flash as it&#8217;s bridge interface). If you&#8217;re interested in contributing other implementations, please let us know.</p>
<p>Note that SVG &amp; VML are &#8220;live&#8221; DOM scene graphs; whereas Canvas is an immediate mode procedural API. When Canvas is used under gfx, you gain the benefits that come with having a live scene graph (plus you can still drop down and access pixel data from the Canvas if you need to). These benefits include being able to move groups of objects around a picture (and in the future, will allow responding to events on Shapes).</p>
</div>
<div class="section" id="core-concepts">
<h3><a class="toc-backref" href="#id9">Core Concepts<a class="headerlink" href="#core-concepts" title="Permalink to this headline">Â¶</a></a></h3>
<p>On a conceptual level dojox.gfx has a simple declarative model.</p>
<p>All basic primitives required for 2D graphics are defined:</p>
<ul class="simple">
<li>2D coordinates</li>
<li>2D linear transformation matrices</li>
<li>Colors</li>
</ul>
<p>There is a <strong>Surface</strong>, which serves as a visual rectangular container for shapes:</p>
<ul class="simple">
<li>A web page can have several surfaces defined.</li>
<li>Each surface has its own local coordinate system:<ul>
<li>(0, 0) point is in the left-top corner, where the X axis is horizontal pointing right, and the Y axis is vertical pointing down.</li>
<li>Positive direction of rotation is defined as clockwise (CW).</li>
</ul>
</li>
<li>All shapes are clipped on the surface boundaries.</li>
<li>By default the background of a surface is transparent.</li>
</ul>
<p>There is a <strong>Shape</strong> description object, which represent a simple description of geometry, with corresponding shape objects. dojox.gfx supports following shapes:</p>
<ul class="simple">
<li>Rectangle (optionally with rounded corners)</li>
<li>Circle</li>
<li>Ellipse</li>
<li>Line</li>
<li>Polyline/polygon</li>
<li>Path (the most versatile shape) Path implements the full SVG path language.</li>
<li>Image</li>
<li>Text</li>
<li>TextPath (experimental)</li>
</ul>
<p>Shapes support two types of properties:</p>
<blockquote>
<p><em>Geometric</em> properties:</p>
<ul class="simple">
<li>Shape description (shape-specific).</li>
<li>Linear transformation specified by 3 x 3 2D matrix.</li>
<li>Font (only for text shapes).</li>
</ul>
<p><em>Visual</em> properties (not supported by the Image shape):</p>
<ul class="simple">
<li>Stroke (outline of a shape).</li>
<li>Fill (interior of a shape).</li>
</ul>
</blockquote>
<p>Shapes are stacked from bottom to top in the order they are added. This z-order can be changed dynamically after a shape has been added using functions on Shape such as moveToFront().</p>
</div>
<div class="section" id="groups">
<h3><a class="toc-backref" href="#id10">Groups<a class="headerlink" href="#groups" title="Permalink to this headline">Â¶</a></a></h3>
<p>Gfx also has the concept of a <strong>Group</strong>, which is a pseudo-shape. Groups combine other shapes (which can include other groups), and can be used to apply transformation to a group.</p>
<p>All group members share a single z-order, but can be re-arranged within a group.
In order to draw a picture a programmer constructs a pseudo-DOM from a surface object, shapes, and groups, sets appropriate attributes, and a picture is drawn automatically by a browser. Modifications of shapes change picture automatically.</p>
<p>The following conventions are used:</p>
<p>While a <strong>Path</strong> is the most universal geometric shape which can emulate almost all other shapes (exceptions: Image, and Text shapes), all frequently-used shapes are provided as a convenience: Rectangle (with optional round corners), Circle, Ellipse, Line, Polyline/Polygon.
All shape description properties are defined using a duck-typing technique, and incomplete shape description definitions are supported. All missing members will be taken from the corresponding default shape definition listed in common.js or from the current shape description object.</p>
<p>Example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">rect</span><span class="p">.</span><span class="nx">setShape</span><span class="p">({</span><span class="nx">width</span><span class="o">:</span> <span class="mi">200</span><span class="p">})</span>
</pre></div>
</div>
<p>In the above example, all missing members will be taken from dojox.gfx.defaultRect object making it equivalent to:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">rect</span><span class="p">.</span><span class="nx">setShape</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="mi">0</span><span class="o">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">0</span><span class="o">,</span> <span class="nx">width</span><span class="o">:</span> <span class="mi">200</span><span class="o">,</span> <span class="nx">height</span><span class="o">:</span> <span class="mi">100</span><span class="o">,</span> <span class="nx">r</span><span class="o">:</span> <span class="mi">0</span><span class="p">}).</span>
</pre></div>
</div>
<p>All shape description objects and visual property objects have a member called &quot;type&quot;, which uniquely identifies a property type. This is a provision for a serialization.</p>
<p>All methods without an apparent return type return their object itself. It is used for chaining multiple operations.</p>
<p>Example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">surface</span><span class="p">.</span><span class="nx">createRect</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="mi">100</span><span class="o">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">50</span><span class="p">}).</span><span class="nx">setFill</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">).</span><span class="nx">setStroke</span><span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="shape-properties-colors-strokes-fills-fonts">
<h2><a class="toc-backref" href="#id11">Shape Properties: Colors, Strokes, Fills &amp; Fonts<a class="headerlink" href="#shape-properties-colors-strokes-fills-fonts" title="Permalink to this headline">Â¶</a></a></h2>
<div class="section" id="color">
<h3><a class="toc-backref" href="#id12">Color<a class="headerlink" href="#color" title="Permalink to this headline">Â¶</a></a></h3>
<p>Anywhere color is accepted following objects can be used to define it:</p>
<ul class="simple">
<li>A valid color name, like: &quot;white&quot;, &quot;black&quot;, &quot;red&quot;, &quot;green&quot;, &quot;lime&quot;, &quot;blue&quot;, &quot;navy&quot;, &quot;gray&quot;, &quot;silver&quot;.
If you want to support all CSS3 color names, don't forget to require dojo.colors module, which provides all necessary CSS3 compatibility.</li>
<li>A valid CSS color code, e.g., &quot;#FF0000&quot; or &quot;#f00&quot;.</li>
<li>An array of RGB or RGBA values, e.g, [255, 0, 0] or [255, 0, 0, 1.0].</li>
<li>A valid dojo.Color object. Internally all other color definitions are converted to this object.</li>
</ul>
</div>
<div class="section" id="stroke-property">
<h3><a class="toc-backref" href="#id13">Stroke property<a class="headerlink" href="#stroke-property" title="Permalink to this headline">Â¶</a></a></h3>
<p>A stroke property is an object that defines how to draw an outline of a shape. It is not supported by an image and a group shapes. Following properties are recognized:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="28%" />
<col width="54%" />
<col width="7%" />
</colgroup>
<tbody valign="top">
<tr><td><strong>Attribute</strong></td>
<td><strong>Expected Value</strong></td>
<td><strong>Description</strong></td>
<td><strong>Since</strong></td>
</tr>
<tr><td>color</td>
<td>SVG color value (string)</td>
<td>Defines a color of an outline. Default: &quot;black&quot;.</td>
<td>1.0</td>
</tr>
<tr><td>style</td>
<td>&quot;Solid&quot;
&quot;ShortDash&quot;
&quot;ShortDot&quot;
&quot;ShortDashDot&quot;
&quot;ShortDashDotDot&quot;
&quot;Dot&quot;
&quot;Dash&quot;
&quot;LongDash&quot;
&quot;DashDot&quot;
&quot;LongDashDot&quot;
&quot;LongDashDotDot&quot;
&quot;none&quot;</td>
<td>Defines a dash pattern.
These values have been modeled after VML's dashStyle parameter,
and behave similarly (dash pattern is specified in terms of line width).
&quot;none&quot; is the same as &quot;Solid&quot;</td>
<td>1.0</td>
</tr>
<tr><td>width</td>
<td>positive number</td>
<td>Defines a width of a stroke in pixels. Default: 1</td>
<td>1.0</td>
</tr>
<tr><td>cap</td>
<td>&quot;butt&quot;
&quot;round&quot;
&quot;square&quot;</td>
<td>Defines a shape of opening and closing of a line.
see SVG 1.1 'stroke-linecap' definition for details.
Default: &quot;butt&quot;</td>
<td>1.0</td>
</tr>
<tr><td>join</td>
<td>&quot;round&quot;
&quot;bevel&quot;
positive number</td>
<td>Defines a shape of joints.
see SVG 1.1 'stroke-linejoin' definition and SVG 1.1 'stroke-miterlimit'
When number, a &quot;miter&quot; style is used with the number defining a miter limit
Default: 4</td>
<td>1.0</td>
</tr>
</tbody>
</table>
<p>By default all shapes are created with &quot;null&quot; stroke meaning &quot;no stroke is performed&quot;.</p>
<p>Stroke can be defined by specifying a color as a string:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">shape</span><span class="p">.</span><span class="nx">setStroke</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>is equivalent to</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">shape</span><span class="p">.</span><span class="nx">setStroke</span><span class="p">({</span><span class="nx">color</span><span class="o">:</span> <span class="s2">&quot;black&quot;</span><span class="p">}).</span>
</pre></div>
</div>
<p>Implementation note: Canvas ignores the line style. All lines are drawn solid.</p>
</div>
<div class="section" id="fill-property">
<h3><a class="toc-backref" href="#id14">Fill property<a class="headerlink" href="#fill-property" title="Permalink to this headline">Â¶</a></a></h3>
<p>A fill property is an object that defines how to fill a shape. It is not supported by an image and a group shapes.</p>
<p>Four types of fills can be used:</p>
<dl class="docutils">
<dt>Solid color fill</dt>
<dd>A single color has been specified as a fill property.</dd>
<dt>Linear gradient</dt>
<dd>Defines a smooth transition between a set of colors (so-called &quot;stops&quot;) on a line. Following properties are recognized:</dd>
</dl>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="28%" />
<col width="54%" />
<col width="7%" />
</colgroup>
<tbody valign="top">
<tr><td><strong>Attribute</strong></td>
<td><strong>Expected Value</strong></td>
<td><strong>Description</strong></td>
<td><strong>Since</strong></td>
</tr>
<tr><td>type</td>
<td>&quot;linear&quot;</td>
<td>Always &quot;linear&quot;</td>
<td>1.0</td>
</tr>
<tr><td>x1</td>
<td>number</td>
<td>Define x start point of linear gradient. Defaults: 0</td>
<td>1.0</td>
</tr>
<tr><td>y1</td>
<td>number</td>
<td>Define y start point of linear gradient. Defaults: 0</td>
<td>1.0</td>
</tr>
<tr><td>x2</td>
<td>number</td>
<td>Define x end point of linear gradient. Defaults: 100</td>
<td>1.0</td>
</tr>
<tr><td>y2</td>
<td>number</td>
<td>Define y end point of linear gradient. Defaults: 100</td>
<td>1.0</td>
</tr>
<tr><td>colors</td>
<td>array[Object]</td>
<td>Defines an array of stop objects.  See stop object properties below.
Default: [{offset: 0, color: &quot;black&quot;}, {offset: 1, color: &quot;white&quot;}]</td>
<td>1.0</td>
</tr>
</tbody>
</table>
<p>These are the properties of Stop objects (for LinearGradient.colors property array entries)</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="28%" />
<col width="54%" />
<col width="7%" />
</colgroup>
<tbody valign="top">
<tr><td><strong>Attribute</strong></td>
<td><strong>Expected Value</strong></td>
<td><strong>Description</strong></td>
<td><strong>Since</strong></td>
</tr>
<tr><td>offset</td>
<td>number [0..1]</td>
<td>A number from 0 to 1 which defines a position of color on our line.
0 corresponds to x1, y1 point
1 corresponds to x2, y2 point
0.5 corresponds to midpoint</td>
<td>1.0</td>
</tr>
<tr><td>color</td>
<td>string (SVG color value)</td>
<td>A color for this stop.</td>
<td>1.0</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Radial gradient</dt>
<dd>Defines a smooth transition between stops on a circle. The following properties are recognized:</dd>
</dl>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="28%" />
<col width="54%" />
<col width="7%" />
</colgroup>
<tbody valign="top">
<tr><td><strong>Attribute</strong></td>
<td><strong>Expected Value</strong></td>
<td><strong>Description</strong></td>
<td><strong>Since</strong></td>
</tr>
<tr><td>type</td>
<td>&quot;radial&quot;</td>
<td>Always &quot;radial&quot;</td>
<td>1.0</td>
</tr>
<tr><td>cx</td>
<td>number</td>
<td>Define x of center point. Defaults: 0</td>
<td>1.0</td>
</tr>
<tr><td>cy</td>
<td>number</td>
<td>Define y of center point. Defaults: 0</td>
<td>1.0</td>
</tr>
<tr><td>r</td>
<td>positive number</td>
<td>Defines a radius of a radial gradient.</td>
<td>1.0</td>
</tr>
<tr><td>colors</td>
<td>array[Object]</td>
<td>Defines an array of stop objects.  See stop object properties above.
Default: [{offset: 0, color: &quot;black&quot;}, {offset: 1, color: &quot;white&quot;}].
offset of 0 corresponds to center of the circle.
offset of 1 corresponds to border of the circle.</td>
<td>1.0</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Pattern</dt>
<dd>Defines an infinite tiling of an image. The following properties are recognized:</dd>
</dl>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="28%" />
<col width="54%" />
<col width="7%" />
</colgroup>
<tbody valign="top">
<tr><td><strong>Attribute</strong></td>
<td><strong>Expected Value</strong></td>
<td><strong>Description</strong></td>
<td><strong>Since</strong></td>
</tr>
<tr><td>type</td>
<td>&quot;pattern&quot;</td>
<td>Always &quot;pattern&quot;</td>
<td>1.0</td>
</tr>
<tr><td>x</td>
<td>number</td>
<td>Define x of offset of a reference rectangle for an image. Defaults: 0</td>
<td>1.0</td>
</tr>
<tr><td>y</td>
<td>number</td>
<td>Define y of offset of a reference rectangle for an image. Defaults: 0</td>
<td>1.0</td>
</tr>
<tr><td>width</td>
<td>positive number</td>
<td>Defines width of the reference rectangle that the image will be scaled to.
Defaults: 0</td>
<td>1.0</td>
</tr>
<tr><td>height</td>
<td>positive number</td>
<td>Defines height of the reference rectangle that the image will be scaled to.
Defaults: 0</td>
<td>1.0</td>
</tr>
<tr><td>src</td>
<td>string (url)</td>
<td>Defines a URL of the image to be tiled.</td>
<td>1.0</td>
</tr>
</tbody>
</table>
<p>By default all shapes are created with &quot;null&quot; fill meaning &quot;no fill is performed&quot;.
Complex shapes with self intersections (e.g., polygons), or disjoint parts (e.g. paths) are filled using the even-odd rule.</p>
<div class="section" id="implementation-details">
<h4>Implementation details<a class="headerlink" href="#implementation-details" title="Permalink to this headline">Â¶</a></h4>
<p>The VML renderer has following restrictions:</p>
<blockquote>
<dl class="docutils">
<dt>Linear gradient</dt>
<dd><p class="first">Should start and stop on a border of a shape.</p>
<p class="last">All other line definitions will be visually incompatible with the SVG implementation of the linear gradient.</p>
</dd>
<dt>Radial gradient</dt>
<dd><p class="first">Repeats the shape of an object.</p>
<p class="last">It means that the only way to define a compatible radial gradient for SVG and VML renderers is to define it from a center of a circle shape.</p>
</dd>
<dt>Transparency (the alpha channel)</dt>
<dd>Is not supported for gradient fills.</dd>
</dl>
</blockquote>
<dl class="docutils">
<dt>SVG (Firefox 1.5-2.0)</dt>
<dd>Doesn't support the pattern fill.</dd>
<dt>Canvas</dt>
<dd>Doesn't support the even-odd rule.</dd>
</dl>
</div>
</div>
<div class="section" id="font-property">
<h3><a class="toc-backref" href="#id15">Font property<a class="headerlink" href="#font-property" title="Permalink to this headline">Â¶</a></a></h3>
<p>Text shapes (Text and TextPath) require a font in order to be rendered. A font description follows familiar CSS conventions.
The following properties of Font are recognized:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="28%" />
<col width="54%" />
<col width="7%" />
</colgroup>
<tbody valign="top">
<tr><td><strong>Attribute</strong></td>
<td><strong>Expected Value</strong></td>
<td><strong>Description</strong></td>
<td><strong>Since</strong></td>
</tr>
<tr><td>style</td>
<td>&quot;normal&quot;,&quot;italic&quot;,&quot;oblique&quot;</td>
<td>Same as the CSS font-style property.   Default: &quot;normal&quot;</td>
<td>1.0</td>
</tr>
<tr><td>variant</td>
<td>&quot;normal&quot;,&quot;small-caps&quot;</td>
<td>Same as the CSS font-variant property.   Default: &quot;normal&quot;</td>
<td>1.0</td>
</tr>
<tr><td>weight</td>
<td>&quot;normal&quot;,&quot;nold&quot;,&quot;bolder&quot;,&quot;lighter&quot;,
100,200,300,400,500,600,700,800,900</td>
<td>Same as the CSS font-weight property.   Default: &quot;normal&quot;</td>
<td>1.0</td>
</tr>
<tr><td>size</td>
<td>css font size value</td>
<td>Same as the CSS font-size property.   Default: &quot;10pt&quot;</td>
<td>1.0</td>
</tr>
<tr><td>family</td>
<td>css font family value</td>
<td>Same as the CSS font-family property.   Default: &quot;serif&quot;</td>
<td>1.0</td>
</tr>
</tbody>
</table>
<p>There is also a useful shortcut: you can specify a font using a string similar to the CSS font property.</p>
<div class="section" id="implementation-notes">
<h4>Implementation notes<a class="headerlink" href="#implementation-notes" title="Permalink to this headline">Â¶</a></h4>
<dl class="docutils">
<dt>IE7</dt>
<dd><p class="first">Broke many VML features.</p>
<p>For example, the family property doesn't work in IE7 at the moment but does work in IE6.</p>
<p class="last">IE7 uses Arial always. Unfortunately there is no workaround for that.</p>
</dd>
<dt>Silverlight has the following restrictions:</dt>
<dd><dl class="first docutils">
<dt>style</dt>
<dd>Only &quot;normal&quot; and &quot;italic&quot; are supported, all other values are interpreted as &quot;normal&quot;.</dd>
<dt>variant</dt>
<dd>Ignored</dd>
<dt>weight</dt>
<dd>&quot;normal&quot; is implemented as 400, &quot;bold&quot; is 700.</dd>
<dt>size</dt>
<dd>fully supported.</dd>
<dt>family</dt>
<dd><p class="first">&quot;serif&quot; and &quot;times&quot; are substituted by &quot;Times New Roman&quot;,</p>
<p>&quot;sans-serif&quot; and &quot;helvetica&quot; are substituted by &quot;Arial&quot;,</p>
<p class="last">&quot;monotone&quot; and &quot;courier&quot; are substituted by &quot;Courier New&quot;,</p>
</dd>
</dl>
<p class="last">The rest is passed unchanged and will be interpreted by the underlying Silverlight renderer.</p>
</dd>
</dl>
<p>By default all shapes are created with &quot;null&quot; font meaning &quot;the default&quot;.</p>
</div>
</div>
</div>
<div class="section" id="coordinates-and-transformations">
<h2><a class="toc-backref" href="#id16">Coordinates and Transformations<a class="headerlink" href="#coordinates-and-transformations" title="Permalink to this headline">Â¶</a></a></h2>
<p>Linear transformations are a very important part of any graphics library. We deal with 2D graphics, and we operate with 3 by 3 matrices:</p>
<div class="highlight-python"><pre>xx xy dx
yx yy dy
0  0  1</pre>
</div>
<p>Because the third row is always constant we use an abbreviated way to write it: {xx: 1, xy: 0, yx: 0, yy: 1, dx: 0, dy: 0} - this is an identity matrix. The same simplification goes for coordinates:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span>
<span class="n">y</span>
<span class="mf">1</span>
</pre></div>
</div>
<p>Because the third element is always 1 we &quot;add&quot; it virtually: {x: 12, y: 33}. The result of application of a matrix to a vector is predictable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xx</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">xy</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dx</span>
<span class="n">yx</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">yy</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span>
</pre></div>
</div>
<p>(The dummy third &quot;coordinate&quot; is skipped in the above example).</p>
<p>In order to understand transformations you need to be familiar with fundamentals of matrices (matrix multiplication, multiplication of a vector by a matrix, order of multiplications). dojox.gfx uses a mnemonic way to describe a matrix: xx scales an X component of a coordinate, yy scales a Y component, xy, and yx affect both components, dx moves an X component, and dy moves a Y component.</p>
<div class="section" id="simple-examples">
<h3><a class="toc-backref" href="#id17">Simple examples<a class="headerlink" href="#simple-examples" title="Permalink to this headline">Â¶</a></a></h3>
<p>Stretch the X dimension by 2:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="nx">xx</span><span class="o">:</span> <span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
<p>Stretch the Y dimension by 0.5 (reduces by 2):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="nx">yy</span><span class="o">:</span> <span class="mf">0.5</span><span class="p">}</span>
</pre></div>
</div>
<p>Shift an X coordinate by 5, a Y coordinate by 10:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="nx">dx</span><span class="o">:</span> <span class="mi">5</span><span class="o">,</span> <span class="nx">dy</span><span class="o">:</span> <span class="mi">10</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="more-complex-examples">
<h3><a class="toc-backref" href="#id18">More complex examples<a class="headerlink" href="#more-complex-examples" title="Permalink to this headline">Â¶</a></a></h3>
<p>Rotate everything by 30 degrees clockwise (CW) around point (0, 0):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="nx">xx</span><span class="o">:</span> <span class="mf">0.866</span><span class="o">,</span> <span class="nx">xy</span><span class="o">:</span> <span class="mf">0.5</span><span class="o">,</span> <span class="nx">yx</span><span class="o">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">,</span> <span class="nx">yy</span><span class="o">:</span> <span class="mf">0.866</span><span class="p">}</span>
</pre></div>
</div>
<p>Rotate everything by 90 degrees CW around (0, 0), and moves things right by 100:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="nx">xx</span><span class="o">:</span> <span class="mi">0</span><span class="o">,</span> <span class="nx">xy</span><span class="o">:</span> <span class="mi">1</span><span class="o">,</span> <span class="nx">yx</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="nx">yy</span><span class="o">:</span> <span class="mi">0</span><span class="o">,</span> <span class="nx">dx</span><span class="o">:</span> <span class="mi">100</span><span class="p">}</span>
</pre></div>
</div>
<p>Don't worry, in most cases you don't need to calculate all members of a transformation matrix directly. As you can see not all members of matrix should be specified - all skipped members going to be copied from the identity matrix. There is a shortcut for scaling - if a number N is used instead of a matrix, it is assumed that it represents a uniform scaling matrix {xx: N, yy: N}.</p>
<p>The way to apply a matrix to a coordinate:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">o</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="n">i</span>
</pre></div>
</div>
<p>Where, i is an input vector (e.g., {x: 1, y: 2}), M is a transformation matrix, o is a resulting vector, and * denotes a multiplication operation.</p>
</div>
<div class="section" id="combining-transformation-matrices">
<h3><a class="toc-backref" href="#id19">Combining Transformation Matrices<a class="headerlink" href="#combining-transformation-matrices" title="Permalink to this headline">Â¶</a></a></h3>
<p>Transformations can be combined together as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">A</span> <span class="o">*</span> <span class="n">B</span> <span class="o">*</span> <span class="n">C</span> <span class="o">*</span> <span class="n">p</span> <span class="o">==</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">B</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span> <span class="o">*</span> <span class="n">p</span> <span class="o">==</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span> <span class="o">*</span> <span class="n">C</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span> <span class="o">==</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">B</span> <span class="o">*</span> <span class="n">C</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span> <span class="o">==</span> <span class="n">A</span> <span class="o">*</span> <span class="n">B</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span> <span class="o">*</span> <span class="n">p</span><span class="p">),</span> <span class="o">...</span>
</pre></div>
</div>
<p>Where A, B, and C are transformation matrices, p is a coordinate vector, and * is a multiplication operation.
The result of all these calculations is the same final coordinate.
Effectively all transformations are always applied from right to left sequentially, and they can be combined producing a matrix,
which defines a complex transformation.
dojox.gfx.matrix defines Matrix2D class, as well as numerous helpers (Matrix2D is propagated to dojox.gfx namespace for convenience).
Most important of them (all in dojox.gfx.matrix namespace) are listed below.
In all signatures a, b, c, and e are numbers (coordinate components or scaling factors),
p is a 2D coordinate, r is an angle in radians, d is an angle in degrees (positive value of an angle is CW), m is a matrix.</p>
</div>
<div class="section" id="transformation-constants">
<h3><a class="toc-backref" href="#id20">Transformation Constants<a class="headerlink" href="#transformation-constants" title="Permalink to this headline">Â¶</a></a></h3>
<dl class="docutils">
<dt>identity</dt>
<dd>A constant, which defines an identity matrix. This matrix doesn't change a picture at all.</dd>
<dt>flipX</dt>
<dd>A constant matrix, which changes a sign of all X coordinates. This matrix mirrors the picture around the Y axis.</dd>
<dt>flipY</dt>
<dd>A constant matrix, which changes a sign of all Y coordinates. This matrix mirrors the picture around the X axis.</dd>
<dt>flipXY</dt>
<dd><p class="first">A constant matrix, which changes a sign of all coordinates.</p>
<p>This matrix rotates the picture by 180 degrees around (0, 0) point.</p>
<p class="last">In other words, it mirrors all points around (0, 0).</p>
</dd>
</dl>
</div>
<div class="section" id="matrix-creation">
<h3><a class="toc-backref" href="#id21">Matrix Creation<a class="headerlink" href="#matrix-creation" title="Permalink to this headline">Â¶</a></a></h3>
<dl class="docutils">
<dt>translate(a, b), translate(p)</dt>
<dd><p class="first">Translates its child shapes:</p>
<p>by {dx: a, dy: b}</p>
<p class="last">by {dx: p.x, dy: p.y}</p>
</dd>
<dt>scale(a, b), scale(a), scale(p)</dt>
<dd><p class="first">Scales its child shapes:</p>
<p>by {xx: a, yy: b}</p>
<p>by {xx: a, yy: a}</p>
<p class="last">by {xx: p.x, yy: p.y}</p>
</dd>
<dt>rotate(r), rotateg(d)</dt>
<dd><p class="first">Rotates the child shapes around (0, 0):</p>
<p>by <strong>r</strong> radians</p>
<p class="last">by <strong>d</strong> degrees</p>
</dd>
<dt>skewX(r), skewXg(d)</dt>
<dd><p class="first">Skews the child shapes around (0, 0) in the X dimension:</p>
<p>by <strong>r</strong> radians</p>
<p class="last">by <strong>d</strong> degrees</p>
</dd>
<dt>skewY(r), skewYg(d)</dt>
<dd><p class="first">Skews a picture around (0, 0) in the Y dimension:</p>
<p>by <strong>r</strong> radians</p>
<p class="last">by <strong>d</strong> degrees</p>
</dd>
</dl>
</div>
<div class="section" id="useful-matrix-operations">
<h3><a class="toc-backref" href="#id22">Useful Matrix Operations<a class="headerlink" href="#useful-matrix-operations" title="Permalink to this headline">Â¶</a></a></h3>
<dl class="docutils">
<dt>invert(m)</dt>
<dd>Inverts a matrix. This useful function calculates a matrix, which will do the opposite transformation to the m matrix effectively undoing it.
For example, scale(2) produces a matrix to scale uniformly a picture by 2. The opposite matrix is going to be scale(0.5).
Note that we can produce the same result with invert(scale(2)).
While it seems complicated for such a simple case, frequently it is the only way to calculate an inverted matrix
for complex transformation, especially when we don't know how it was produced initially.</dd>
<dt>clone(m)</dt>
<dd>Create a copy of the m matrix.</dd>
<dt>multiplyPoint(m, a, b), multiplyPoint(m, p)</dt>
<dd>Apply a transformation to a coordinate.</dd>
<dt>multiply(m1, m2, ...)</dt>
<dd>Multiply all parameters to create a single matrix.
This function is extremely useful and there is a shortcut for it:
anywhere a matrix is expected, an array of matrices can be specified as well.</dd>
</dl>
<div class="section" id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">Â¶</a></h4>
<p>Rotate everything 45 degrees CW around (0, 0) and scales everything by 2 after that:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">2</span><span class="o">,</span> <span class="nx">rotateg</span><span class="p">(</span><span class="mi">45</span><span class="p">)]</span>
</pre></div>
</div>
<p>Scale all X coordinates by 2, and moves the result down by 10:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[{</span><span class="nx">dy</span><span class="o">:</span> <span class="mi">10</span><span class="p">}</span><span class="o">,</span> <span class="nx">scale</span><span class="p">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="section" id="more-complex-example">
<h4>More complex example<a class="headerlink" href="#more-complex-example" title="Permalink to this headline">Â¶</a></h4>
<p>Imagine you have a surface 500 by 500 pixels, and you want everything in it to be magnified around its center by 2, and rotated (around the center as well) by 30 degrees CW.</p>
<p>It is easy:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="nx">translate</span><span class="p">(</span><span class="mi">250</span><span class="o">,</span> <span class="mi">250</span><span class="p">)</span><span class="o">,</span> <span class="nx">rotateg</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">,</span> <span class="nx">scale</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">,</span> <span class="nx">translate</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="o">,</span> <span class="o">-</span><span class="mi">250</span><span class="p">)]</span>
</pre></div>
</div>
<p>All scaling, rotating, and skewing operations work around (0, 0) point.
Let's begin by moving the center of our picture to (0, 0):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">translate</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="o">,</span> <span class="o">-</span><span class="mi">250</span><span class="p">).</span>
</pre></div>
</div>
<p>Now we can scale it:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">scale</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can rotate it:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">rotateg</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let's move our center back:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">translate</span><span class="p">(</span><span class="mi">250</span><span class="o">,</span> <span class="mi">250</span><span class="p">)</span>
</pre></div>
</div>
<p>You can see that this kind of transformations follow a &quot;sandwich&quot; pattern, where the first and the last transformation
move an immutable point to/from the origin of coordinates. These &quot;around the point&quot; operations are so important that
there are several helpers for common transformations.</p>
</div>
</div>
<div class="section" id="transformations-around-a-point">
<h3><a class="toc-backref" href="#id23">Transformations Around a Point<a class="headerlink" href="#transformations-around-a-point" title="Permalink to this headline">Â¶</a></a></h3>
<dl class="docutils">
<dt>scaleAt(a, p), scaleAt(a, b, c), scaleAt(a, b, p), scaleAt(a, b, c, e)</dt>
<dd><p class="first">scale(a) around (p.x, p.y)</p>
<p>scale(a) around (b, c)</p>
<p>scale(a, b) around (p.x, p.y)</p>
<p class="last">scale(a, b) around (c, e)</p>
</dd>
<dt>rotateAt(r, p), rotateAt(r, a, b), rotategAt(d, p), rotategAt(d, a, b)</dt>
<dd><p class="first">rotate(r) at (p.x, p.y)</p>
<p>rotate(r) at (a, b)</p>
<p>rotateg(d) at (p.x, p.y)</p>
<p class="last">rotateg(d) at (a, b)</p>
</dd>
<dt>skewXAt(r, p), skewXAt(r, a, b), skewXgAt(d, p), skewXgAt(d, a, b), skewYAt(r, p), skewYAt(r, a, b), skewYgAt(d, p), skewYgAt(d, a, b)</dt>
<dd><p class="first">skewX(r) at (p.x, p.y)</p>
<p>skewX(r) at (a, b)</p>
<p>skewXg(d) at (p.x, p.y)</p>
<p>skewXg(d) at (a, b)</p>
<p>skewY(r) at (p.x, p.y)</p>
<p>skewY(r) at (a, b)</p>
<p>skewYg(d) at (p.x, p.y)</p>
<p class="last">skewYg(d) at (a, b)</p>
</dd>
<dt>normalize(m)</dt>
<dd><p class="first">Returns a matrix in its canonical representation:</p>
<p>normalize(2)</p>
<p>normalize({dy: 5})</p>
<p>normalize([scale(2), translate(100, 200)])</p>
<p>The same effect can be achieved with creating a matrix directly:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">new</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">gfx</span><span class="p">.</span><span class="nx">Matrix2D</span><span class="p">(</span><span class="nx">m</span><span class="p">).</span>
</pre></div>
</div>
<p class="last">By default all shapes are created with &quot;null&quot; matrix meaning &quot;the identity transformation&quot;.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="common-shape-methods">
<h2><a class="toc-backref" href="#id24">Common Shape Methods<a class="headerlink" href="#common-shape-methods" title="Permalink to this headline">Â¶</a></a></h2>
<p>All shape objects support following methods:</p>
<dl class="docutils">
<dt>getShape()/setShape(shape)</dt>
<dd>Accesses an underlying shape description object. A group shape ignores this property.</dd>
<dt>getStroke()/setStroke(stroke)</dt>
<dd>Accesses a stroke applied to a shape. Value of &quot;null&quot; means &quot;do not stroke this shape&quot;. Image and group shapes ignore this property.</dd>
<dt>getFill()/setFill(fill)</dt>
<dd>Accesses a fill applied to a shape. Value of &quot;null&quot; means &quot;do not fill this shape&quot;. Image and group shapes ignore this property.</dd>
<dt>getTransform()/setTransform(matrix)</dt>
<dd>Accesses a transformation matrix applied to a shape. Value of &quot;null&quot; means &quot;the identity transformation&quot;.</dd>
<dt>applyRightTransform(matrix)/applyLeftTransform(matrix)</dt>
<dd>Combines the existing matrix with new matrix. See &quot;Transformation matrix&quot; for details.</dd>
<dt>applyTransform(matrix)</dt>
<dd>An alias for applyRightTransform(matrix). It is defined for convenience.</dd>
<dt>moveToFront()/moveToBack()</dt>
<dd>Changes a z-order of a shape. It moves an object to the front or to the back respectively of its parent container (a surface or a group).</dd>
<dt>removeShape()</dt>
<dd>Removes a shape from its parent container.</dd>
<dt>getParent()</dt>
<dd>Accesses shape's parent container.</dd>
<dt>getBoundingBox()</dt>
<dd>Returns a bounding box of a shape. A text shape is a point-based object, so it doesn't define a bounding box.</dd>
<dt>getTransformedBoundingBox()</dt>
<dd>Returns four point array, which represents four corners of the bounding box transformed by all applicable transformations.</dd>
</dl>
<div class="section" id="event-processing">
<h3><a class="toc-backref" href="#id25">Event processing<a class="headerlink" href="#event-processing" title="Permalink to this headline">Â¶</a></a></h3>
<p>Every shape and a surface object supports connect() and disconnect() methods, which are signature-compatible with dojo.connect() and dojo.disconnect() methods:</p>
<dl class="docutils">
<dt>connect(name, object, method)</dt>
<dd>Connects an event processor to the event named &quot;name&quot; on this shape/surface, and returns a token for this connection.</dd>
<dt>disconnect(token)</dt>
<dd>Disconnects the event processing.</dd>
</dl>
<p>See the api documentation of dojo.connect() and dojo.disconnect() for more details.</p>
<div class="section" id="id2">
<h4>Implementation notes<a class="headerlink" href="#id2" title="Permalink to this headline">Â¶</a></h4>
<p>Shape-specific methods are used to hide the complexity of event handling for non-HTML DOM based renderers (e.g., Silverlight).</p>
<p>Canvas doesn't support event processing. We may implement it externally in the future.</p>
<p>Silverlight supports following events: onclick, onmouseenter, onmouseleave, onmousedown, onmouseup, onmousemove, onkeydown, onkeyup.
If you want to target the broadest range of renderers, you are advised to restrict yourself to this list of events.</p>
</div>
</div>
<div class="section" id="helper-methods">
<h3><a class="toc-backref" href="#id26">Helper Methods<a class="headerlink" href="#helper-methods" title="Permalink to this headline">Â¶</a></a></h3>
<p>In general the described generic methods together with shape-specific methods are enough to do everything with your shape,
but for convenience shape defines a helper method:</p>
<dl class="docutils">
<dt>_getRealMatrix()</dt>
<dd>Returns a combined matrix for this shape applying all parent matrices.
The resulting matrix can be used to transform from &quot;shape&quot; coordinates to &quot;surface&quot; coordinates and back helping to process
mouse events, or coordinating other objects outside of the surface.</dd>
</dl>
</div>
</div>
<div class="section" id="individual-graphics-objects">
<h2><a class="toc-backref" href="#id27">Individual graphics objects<a class="headerlink" href="#individual-graphics-objects" title="Permalink to this headline">Â¶</a></a></h2>
<p>This is a list of all important graphics objects and geometric shapes.</p>
<div class="section" id="surface">
<h3><a class="toc-backref" href="#id28">Surface<a class="headerlink" href="#surface" title="Permalink to this headline">Â¶</a></a></h3>
<blockquote>
<p>A surface is the main object, which represents a collection of shapes. No shapes can be drawn or created without a surface.
The following functions can be used to create a surface object:</p>
<dl class="docutils">
<dt>dojox.gfx.createSurface(parentNode, width, height)</dt>
<dd>Returns a newly created surface object.</dd>
<dt>dojox.gfx.attachSurface(node)</dt>
<dd>Returns a re-created surface object built from an existing node.
The node argument is assumed to be created by createSurface() function (rawNode member).</dd>
</dl>
<p>A surface supports following methods:</p>
<dl class="docutils">
<dt>getDimensions()/setDimensions(widht, height)</dt>
<dd>Accesses sizes set on the surface.</dd>
<dt>createShape(shape)</dt>
<dd><p class="first">Creates a shape out of shape description object relying on the &quot;type&quot; member, returns a shape object.</p>
<p class="last">Useful for deserialization of shapes from an external source.</p>
</dd>
<dt>createPath(path), createRect(rect), createCircle(circle), createEllipse(ellipse), createLine(line), createPolyline(polyline), createImage(image), createText(text), createTextPath(textpath)</dt>
<dd><p class="first">Create a corresponding shape returning a shape object.</p>
<p class="last">Note: the &quot;type&quot; member of a shape is implied and not required.</p>
</dd>
<dt>createGroup()</dt>
<dd>Creates a Group object.</dd>
<dt>add(shape)</dt>
<dd>Adds a <strong>Shape</strong> to a <strong>Surface</strong> returning the surface itself. Used to move shapes between groups and a surface.</dd>
<dt>remove(shape)</dt>
<dd>Removes a shape from a surface returning the surface itself.
The shape can be added later to the same surface or a group.</dd>
<dt>clear()</dt>
<dd>Removes all shapes from a surface returning the surface itself.</dd>
<dt>connect() and disconnect()</dt>
<dd>See the discussion of these methods in the Event processing section above.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="group">
<h3><a class="toc-backref" href="#id29">Group<a class="headerlink" href="#group" title="Permalink to this headline">Â¶</a></a></h3>
<blockquote>
<p>A group is a pseudo-shape, which represents a collection of shapes.
Transformations applied to a group applied to all shapes of that group.
It is used to aggregate shapes constructing a more complex shape, or to manage sub-pictures.
The other way to use a group is to aggregate an event processing.
It is planned to implement setting a (default) visual parameters to group's children including fill, stroke, and font properties.
A group combines features of a shape and a surface. It shares following methods with a shape:</p>
<dl class="docutils">
<dt>getTransform()/setTransform(matrix)</dt>
<dd>Accesses a transformation matrix applied to a group.</dd>
<dt>applyRightTransform(matrix)/applyLeftTransform(matrix)</dt>
<dd>Combines the existing matrix with new matrix.
See &quot;Transformation matrix&quot; for details.</dd>
<dt>applyTransform(matrix)</dt>
<dd>Is an alias for applyRightTransform(matrix). This function is defined for convenience.</dd>
<dt>moveToFront()/moveToBack()</dt>
<dd>Changes a z-order of a group. It moves an object to the front or to the back respectively
of its parent container (a surface or a group).</dd>
<dt>removeShape()</dt>
<dd>Removes a group from its parent container.</dd>
<dt>getParent()</dt>
<dd>Accesses group's parent container.</dd>
<dt>connect()/disconnect()</dt>
<dd>Implement the event processing.</dd>
</dl>
<p>Group also shares the following methods with a Surface:</p>
<dl class="docutils">
<dt>createShape(shape)</dt>
<dd><p class="first">Creates a shape out of shape description object relying on the &quot;type&quot; member, returns a shape object.</p>
<p class="last">Useful for deserialization of shapes from an external source.</p>
</dd>
<dt>createPath(path), createRect(rect), createCircle(circle), createEllipse(ellipse), createLine(line), createPolyline(polyline), createImage(image), createText(text), createTextPath(textpath)</dt>
<dd><p class="first">Create a corresponding shape returning a shape object.</p>
<p class="last">Note: the &quot;type&quot; member of a shape is implied and not required.</p>
</dd>
<dt>createGroup()</dt>
<dd>Creates a group object.</dd>
<dt>add(shape)</dt>
<dd>Adds a shape to a surface returning the surface itself. It is used to move shapes between groups and a surface.</dd>
<dt>remove(shape)</dt>
<dd>Removes a shape from a surface returning the surface itself. The shape can be added later to the same surface or a group.</dd>
<dt>clear()</dt>
<dd>Removes all shapes from a surface returning the surface itself.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="rectangle">
<h3><a class="toc-backref" href="#id30">Rectangle<a class="headerlink" href="#rectangle" title="Permalink to this headline">Â¶</a></a></h3>
<blockquote>
<p>A rectangle is a basic rectangular shape with optionally rounded corners.
It can be created by the createRect() method of a surface or a group.
The default shape description for rectangle is defined as the dojox.gfx.defaultRect object.
Here is a list of all properties and their defaults:</p>
<dl class="docutils">
<dt>type</dt>
<dd>is always &quot;rect&quot;.</dd>
<dt>x, y</dt>
<dd>Coordinates of a top-left corner in pixels. Defaults: 0, 0.</dd>
<dt>width, height</dt>
<dd>Dimensions in pixels. Defaults: 100, 100.</dd>
<dt>r</dt>
<dd>A radius of rounded corners. Default: 0 (no rounded corners).</dd>
</dl>
</blockquote>
</div>
<div class="section" id="circle">
<h3><a class="toc-backref" href="#id31">Circle<a class="headerlink" href="#circle" title="Permalink to this headline">Â¶</a></a></h3>
<blockquote>
<p>A circle is a basic shape. It can be created by the createCircle() method of a surface or a group.
The default shape description for circle is defined as the dojox.gfx.defaultCircle object.
Here is a list of all properties and their defaults:</p>
<dl class="docutils">
<dt>type</dt>
<dd>Is always &quot;circle&quot;</dd>
<dt>cx, cy</dt>
<dd>Coordinates of a center in pixels. Defaults: 0, 0</dd>
<dt>r</dt>
<dd>Is a radius in pixels. Default: 100</dd>
</dl>
</blockquote>
</div>
<div class="section" id="ellipse">
<h3><a class="toc-backref" href="#id32">Ellipse<a class="headerlink" href="#ellipse" title="Permalink to this headline">Â¶</a></a></h3>
<blockquote>
<p>An Ellipse is a basic shape. It can be created by the createEllipse() method of a surface or a group.
The default shape description for ellipse is defined as the dojox.gfx.defaultEllipse object.
An ellipse can be used to emulate a circle.
Here is a list of all properties and their defaults:</p>
<dl class="docutils">
<dt>type</dt>
<dd>Always &quot;ellipse&quot;</dd>
<dt>cx, cy</dt>
<dd>Coordinates of a center in pixels. Defaults: 0, 0</dd>
<dt>rx, ry</dt>
<dd>Horizontal and vertical radii (respectively) in pixels. Defaults: 200, 100</dd>
</dl>
</blockquote>
</div>
<div class="section" id="line">
<h3><a class="toc-backref" href="#id33">Line<a class="headerlink" href="#line" title="Permalink to this headline">Â¶</a></a></h3>
<blockquote>
<p>A Line is a basic shape that connects two points. It can be created by the createLine() method of a surface or a group.
The default shape description for line is defined as the dojox.gfx.defaultLine object.
Here is a list of all properties and their defaults:</p>
<dl class="docutils">
<dt>type</dt>
<dd>Always &quot;line&quot;</dd>
<dt>x1, y1</dt>
<dd>Coordinates of a start point in pixels. Defaults: 0, 0</dd>
<dt>x2, y2</dt>
<dd>Coordinates of an end point in pixels. Defaults: 100, 100</dd>
</dl>
</blockquote>
</div>
<div class="section" id="polyline">
<h3><a class="toc-backref" href="#id34">Polyline<a class="headerlink" href="#polyline" title="Permalink to this headline">Â¶</a></a></h3>
<blockquote>
<p>A Polyline is a basic shape, which can be used to represent polylines and polygons.
It can be created by the createPolyline() method of a surface or a group.
The default shape description for polyline is defined as the dojox.gfx.defaultPolyline object.
Typically a polyline is an unfilled polygon. A polyline can be &quot;open&quot; and &quot;closed&quot;.
The latter means that the first and the last points are the same.
When filling open polylines, an edge connecting the first and the last points is assumed.
Polylines/polygons can be defined as an array of points:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">poly</span><span class="p">.</span><span class="nx">setShape</span><span class="p">([{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">0</span><span class="o">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">0</span><span class="p">}</span><span class="o">,</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">100</span><span class="o">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">100</span><span class="p">}])</span> <span class="nx">and</span> <span class="nx">poly</span><span class="p">.</span><span class="nx">setShape</span><span class="p">([</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
<p>are both equivalent to</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">poly</span><span class="p">.</span><span class="nx">setShape</span><span class="p">({</span><span class="nx">points</span><span class="o">:</span> <span class="p">[{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">0</span><span class="o">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">0</span><span class="p">}</span><span class="o">,</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">100</span><span class="o">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">100</span><span class="p">}]}).</span>
</pre></div>
</div>
<p>A polyline can be used to emulate a line.
Here is a list of all properties and their defaults:</p>
<dl class="docutils">
<dt>type</dt>
<dd>Always &quot;polyline&quot;.</dd>
<dt>points</dt>
<dd>An array of 2D coordinates in pixels. Default: [].</dd>
</dl>
</blockquote>
</div>
<div class="section" id="path">
<h3><a class="toc-backref" href="#id35">Path<a class="headerlink" href="#path" title="Permalink to this headline">Â¶</a></a></h3>
<blockquote>
<p>A Path is the most versatile geometric shape, which can emulate all other geometric shapes.
It can be created by the createPath() method of a surface or a group.</p>
<p>The default shape description for path is defined as the dojox.gfx.defaultPath object.</p>
<p>Here is a list of all properties and their defaults:</p>
<dl class="docutils">
<dt>type</dt>
<dd>Always &quot;path&quot;.</dd>
<dt>path</dt>
<dd>A string , which represents a path encoded in the SVG path language. Default: &quot;&quot;.</dd>
</dl>
<p>A path can be open or closed. The latter means that the first and the last points are the same.</p>
<p>When filling open paths, a straight line connecting the first and the last points is assumed.</p>
<p>Path supports following methods for building path segments programmatically:</p>
<dl class="docutils">
<dt>moveTo(x,y)</dt>
<dd>Starts new segment abandoning the previous segment, if any. It takes a coordinate as a parameter.</dd>
<dt>lineTo(x,y)</dt>
<dd>Draws a straight line from the last point to the argument (coordinate).</dd>
<dt>hLineTo(x)</dt>
<dd>Draws a straight horizontal line from the last point using the argument (a number) as X position.</dd>
<dt>vLineTo(y)</dt>
<dd>Draws a straight vertical line from the last point using the argument (a number) as Y position.</dd>
<dt>curveTo(x1,y1,x2,y2,x,y)</dt>
<dd>Draws a cubic BÃ©zier curve from the last point using arguments (two control points, and a final coordinate).</dd>
<dt>smoothCurveTo(x2,y2,x,y)</dt>
<dd>Draws a cubic BÃ©zier curve from the last point using arguments. The difference between this method and curveTo()
is that it accepts only one control point, which serves as the second control point. The first control is assumed
to be a reflection of the second control point of the previous curve command.</dd>
<dt>qCurveTo(x1,y1,x,y)</dt>
<dd>Draws a quadratic BÃ©zier curve from the last point using arguments (a control point, and a final point).</dd>
<dt>qSmoothCurveTo(x,y)</dt>
<dd>Draws a quadratic BÃ©zier curve from the last point using arguments. The difference between this method and qCurveTo()
is that it uses the reflected control point of the previous curve command.</dd>
<dt>arcTo(rx,ry,x_axis_rotation,large_arc_flag,sweep_flag,x,y)</dt>
<dd>Draws an elliptic arc from the last point using arguments (please see the above link for details).</dd>
<dt>closePath()</dt>
<dd>Closes the segment.</dd>
<dt>setAbsoluteMode(mode)</dt>
<dd>Sets an absolute or relative mode for coordinates. In the absolute mode all coordinates are assumed to be literal.
In the relative mode all coordinates are offsets from the last point.</dd>
<dt>getAbsoluteMode()</dt>
<dd>Returns true, if the current mode is absolute.</dd>
<dt>getLastPosition()</dt>
<dd>Returns the last point, if there is one.</dd>
</dl>
</blockquote>
<div class="section" id="id3">
<h4>Examples<a class="headerlink" href="#id3" title="Permalink to this headline">Â¶</a></h4>
<p>All parameters can be repeated, if it makes sense.</p>
<p>Example:</p>
<blockquote>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">path</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>is equivalent to</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">path</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="p">).</span><span class="nx">lineTo</span><span class="p">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="p">).</span><span class="nx">lineTo</span><span class="p">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="p">).</span>
</pre></div>
</div>
</blockquote>
<p>A pair of coordinates can be replaced by a single coordinate object.</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first highlight-javascript"><div class="highlight"><pre><span class="nx">path</span><span class="p">.</span><span class="nx">curveTo</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="mf">0.5</span><span class="o">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">0</span><span class="p">}</span><span class="o">,</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mf">0.5</span><span class="o">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span><span class="p">}</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>is equivalent to</p>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="nx">path</span><span class="p">.</span><span class="nx">curveTo</span><span class="p">(</span><span class="mf">0.5</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mf">0.5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="p">).</span>
</pre></div>
</div>
</dd>
</dl>
<p>All arrays are unrolled.</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first highlight-javascript"><div class="highlight"><pre><span class="nx">path</span><span class="p">.</span><span class="nx">curveTo</span><span class="p">([</span><span class="mf">0.5</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="o">,</span> <span class="mi">1</span><span class="p">]]</span><span class="o">,</span> <span class="p">[{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="o">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span><span class="p">}])</span>
</pre></div>
</div>
<p>is equivalent to</p>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="nx">path</span><span class="p">.</span><span class="nx">curveTo</span><span class="p">(</span><span class="mf">0.5</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mf">0.5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="p">).</span>
</pre></div>
</div>
</dd>
</dl>
<p>You can specify a well-formed path string as an argument to setShape() method of the path:</p>
<blockquote>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">path</span><span class="p">.</span><span class="nx">setShape</span><span class="p">(</span><span class="s2">&quot;m 0,0 l 100, 100 e&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>is equivalent to</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">path</span><span class="p">.</span><span class="nx">setShape</span><span class="p">({</span><span class="nx">path</span><span class="o">:</span> <span class="s2">&quot;m 0,0 l 100, 100 e&quot;</span><span class="p">})</span>
</pre></div>
</div>
</blockquote>
</div>
</div>
<div class="section" id="image">
<h3><a class="toc-backref" href="#id36">Image<a class="headerlink" href="#image" title="Permalink to this headline">Â¶</a></a></h3>
<blockquote>
<p>An Image is a shape that represents a resolution-independent color bitmap data.
It can be created by the createImage() method of a Surface or a Group.</p>
<p>The default shape description for image is defined as the dojox.gfx.defaultImage object.</p>
<p>Here is a list of all properties and their defaults:</p>
<dl class="docutils">
<dt>type</dt>
<dd>Always &quot;image&quot;.</dd>
<dt>x, y</dt>
<dd>Coordinates of a top-left corner in pixels. Defaults: 0, 0.</dd>
<dt>width, height</dt>
<dd>Dimensions in pixels. Defaults: 0, 0 - don't forget to set them to real values.</dd>
<dt>src</dt>
<dd>A URL of an image data pointing to a GIF, JPG, or PNG file. Default: &quot;&quot;.</dd>
</dl>
<p>Changing width and height parameters you can stretch/shrink an image anisotropically.</p>
</blockquote>
</div>
<div class="section" id="text">
<h3><a class="toc-backref" href="#id37">Text<a class="headerlink" href="#text" title="Permalink to this headline">Â¶</a></a></h3>
<blockquote>
<p>Text is a shape that anchors a text string to a point. It can be created by the createText() method of a Surface or a Group.
It implements these additional text-specific methods:</p>
<dl class="docutils">
<dt>setFont(font)</dt>
<dd>Sets a font object.</dd>
<dt>getFont()</dt>
<dd>Returns the current font, or &quot;null&quot; to indicate that the default font is used.</dd>
</dl>
<p>The default shape description for text shape is defined as the dojox.gfx.defaultText object.
Here is a list of all properties and their defaults:</p>
<dl class="docutils">
<dt>type</dt>
<dd>Always &quot;text&quot;.</dd>
<dt>x, y</dt>
<dd>Coordinates of a text anchor. Defaults: 0, 0.</dd>
<dt>text</dt>
<dd>A string of characters you want to show aligned to the anchor poistion. Default: &quot;&quot;.</dd>
<dt>align</dt>
<dd><p class="first">An alignment of a text in regards to the anchor position:</p>
<dl class="last docutils">
<dt>&quot;start&quot;</dt>
<dd>A text's baseline starts at the anchor. This is the default value of the align attribute.</dd>
<dt>&quot;middle&quot;</dt>
<dd>A text's baseline is centered on the anchor point.</dd>
<dt>&quot;end&quot;</dt>
<dd>A text's baseline ends at the anchor point.</dd>
</dl>
</dd>
<dt>decoration</dt>
<dd><p class="first">A hint on how to render optional elements of a text:</p>
<dl class="last docutils">
<dt>&quot;none&quot;</dt>
<dd>Text is not decorated. This is the default value.</dd>
<dt>&quot;underline&quot;</dt>
<dd>Text is underlined.</dd>
<dt>&quot;overline&quot;</dt>
<dd>Text has a line above it.</dd>
<dt>&quot;line-through&quot;</dt>
<dd>Text has a line through the middle.</dd>
</dl>
</dd>
<dt>rotated</dt>
<dd><p class="first">A Boolean value, which indicates:</p>
<dl class="last docutils">
<dt>false</dt>
<dd>All glyphs are unrotated. The is the default value.</dd>
<dt>true</dt>
<dd>All glyphs are rotated 90 degrees counter-clock-wise. This mode is useful for vertically arranged text.</dd>
</dl>
</dd>
<dt>kerning</dt>
<dd><p class="first">A Boolean value, which indicates:</p>
<dl class="last docutils">
<dt>true</dt>
<dd>Kerning is on. This is the default value.</dd>
<dt>false</dt>
<dd>Kerning is off.</dd>
</dl>
</dd>
</dl>
</blockquote>
<div class="section" id="id4">
<h4>Implementation notes<a class="headerlink" href="#id4" title="Permalink to this headline">Â¶</a></h4>
<p>Text properties are loosely based on properties of the SVG text element.</p>
<dl class="docutils">
<dt>IE7</dt>
<dd><p class="first">Broke a lot of VML features.</p>
<p>The following things work in IE6 but don't work in IE7 (and there is no workaround for them):</p>
<blockquote class="last">
<dl class="docutils">
<dt>decoration</dt>
<dd>Always &quot;none&quot;.</dd>
<dt>rotated</dt>
<dd>Always false.</dd>
</dl>
</blockquote>
</dd>
<dt>FF2 and Opera9</dt>
<dd><p class="first">Do not support following properties:</p>
<dl class="last docutils">
<dt>decoration</dt>
<dd>Always &quot;none&quot;.</dd>
<dt>rotated</dt>
<dd>Always false.</dd>
</dl>
</dd>
<dt>Silverlight</dt>
<dd><p class="first">Has following restrictions:</p>
<dl class="last docutils">
<dt>stroke</dt>
<dd>Not supported - all setStroke() calls are ignored.</dd>
<dt>decoration</dt>
<dd>Only &quot;underline&quot; and &quot;none&quot; are supported, the rest is interpreted as &quot;none&quot;.</dd>
<dt>rotated and kerning properties</dt>
<dd>Not supported.</dd>
</dl>
</dd>
<dt>Canvas</dt>
<dd>Same as Silverlight</dd>
</dl>
</div>
</div>
<div class="section" id="textpath">
<h3><a class="toc-backref" href="#id38">TextPath<a class="headerlink" href="#textpath" title="Permalink to this headline">Â¶</a></a></h3>
<blockquote>
<p>A TextPath is a shape that flows text along an arbitrary path. TextPath properties are based on the text shape properties.</p>
<p>It can be created by the createTextPath() method of a surface or a group.</p>
<p>The TextPath shape object implements all methods of a Path shape object, and two additional methods:</p>
<dl class="docutils">
<dt>setFont(font)</dt>
<dd>Sets a font object.</dd>
<dt>getFont()</dt>
<dd>Returns the current font, or &quot;null&quot; to indicate that the default font is used.</dd>
<dt>setText(text)</dt>
<dd>Sets a text path shape description.</dd>
</dl>
<p>The default shape description for text path shape is defined as the dojox.gfx.defaultTextPath object.</p>
<p>It resembles the text description object.</p>
<p>Here is a list of all properties and their defaults:</p>
<dl class="docutils">
<dt>type</dt>
<dd>Always &quot;textpath&quot;.</dd>
<dt>text</dt>
<dd>A string of characters you want to show on a path. Default: &quot;&quot;.</dd>
<dt>align</dt>
<dd><p class="first">An alignment of a text in regards to the anchor position:</p>
<dl class="last docutils">
<dt>&quot;start&quot;</dt>
<dd>Text starts at the beginning of the path. This is the default value of the align attribute.</dd>
<dt>&quot;middle&quot;</dt>
<dd>Text is centered on the middle of the path.</dd>
<dt>&quot;end&quot;</dt>
<dd>Text ends at the end of the path.</dd>
</dl>
</dd>
<dt>decoration</dt>
<dd><p class="first">A hint on how to render optional elements of a text:</p>
<dl class="last docutils">
<dt>&quot;none&quot;</dt>
<dd>Text is not decorated. This is the default value.</dd>
<dt>&quot;underline&quot;</dt>
<dd>Text is underlined.</dd>
<dt>&quot;overline&quot;</dt>
<dd>Text has a line above it.</dd>
<dt>&quot;line-through&quot;</dt>
<dd>Text has a line through the middle.</dd>
</dl>
</dd>
<dt>rotated</dt>
<dd><p class="first">A Boolean value, which indicates:</p>
<dl class="last docutils">
<dt>false</dt>
<dd>All glyphs are unrotated. The is the default value.</dd>
<dt>true</dt>
<dd>All glyphs are rotated 90 degrees counter-clockwise. This mode is useful for vertically arranged text.</dd>
</dl>
</dd>
<dt>kerning</dt>
<dd><p class="first">A Boolean value, which indicates:</p>
<dl class="last docutils">
<dt>true</dt>
<dd>Kerning is on. This is the default value.</dd>
<dt>false</dt>
<dd>Kerning is off.</dd>
</dl>
</dd>
</dl>
</blockquote>
<div class="section" id="id5">
<h4>Implementation notes<a class="headerlink" href="#id5" title="Permalink to this headline">Â¶</a></h4>
<p>This is an experimental shape, which is not recommended to be used in production unless you know what you are doing.</p>
<p>TextPath shape properties mirror properties of a Text shape.
When TextPath object is created its path is set to dojox.gfx.defaultPath.</p>
<dl class="docutils">
<dt>IE7</dt>
<dd><p class="first">Broke a lot of VML features.</p>
<p>The following things work in IE6 but don't work in IE7 (and there is no workaround for them):</p>
<dl class="last docutils">
<dt>decoration</dt>
<dd>Always &quot;none&quot;</dd>
<dt>rotated</dt>
<dd>Always false</dd>
</dl>
</dd>
<dt>FF2 and Opera9</dt>
<dd><p class="first">Do not support the following properties:</p>
<dl class="last docutils">
<dt>decoration</dt>
<dd>Always &quot;none&quot;</dd>
<dt>rotated</dt>
<dd>Always false</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="alignment">
<h4>Alignment<a class="headerlink" href="#alignment" title="Permalink to this headline">Â¶</a></h4>
<p>IE always aligns the vertical middle of the text with a path.</p>
<p>FF and Opera both align the baseline with a path.</p>
<blockquote>
Unfortunately they seem to ignore any other vertical alignment, which leads to a visual discrepancy between SVG and VML implementations.</blockquote>
<p>The final version of the TextPath object will have the IE/VML behavior (as the greater common denominator):</p>
<blockquote>
The text's middle line follows a path.</blockquote>
<dl class="docutils">
<dt>Silverlight and Canvas</dt>
<dd>don't support this shape.</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="utilities">
<h2><a class="toc-backref" href="#id39">Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">Â¶</a></a></h2>
<p>dojox.gfx implements several generally useful algorithms described in this section.</p>
<div class="section" id="move-js">
<h3><a class="toc-backref" href="#id40">move.js<a class="headerlink" href="#move-js" title="Permalink to this headline">Â¶</a></a></h3>
<p>This file implements dojox.gfx.Mover and dojox.gfx.Moveable which are similar to dojo.dndMover and dojo.dnd.Moveable specifically targeting moving shapes.</p>
<p>You can find examples in dojox/gfx/demos/circles.html, and dojox/gfx/demos/inspector.html.</p>
</div>
<div class="section" id="utils-js">
<h3><a class="toc-backref" href="#id41">utils.js<a class="headerlink" href="#utils-js" title="Permalink to this headline">Â¶</a></a></h3>
<p>This file implements serialization helpers:</p>
<dl class="docutils">
<dt>serialize(shape)</dt>
<dd>Takes a shape or a surface and returns a DOM object, which describes underlying shapes.</dd>
<dt>deserialize(parent, object)</dt>
<dd>Takes a surface or a shape and populates it with an object produced by serialize().</dd>
<dt>toJson(shape, prettyPrint)</dt>
<dd>Works just like serialize() but returns a JSON string. If prettyPrint is true, the string is pretty-printed to make it more human-readable.</dd>
<dt>fromJson(parent, json)</dt>
<dd>Works just like deserialize() but takes a JSON representation of the object.</dd>
<dt>serialize()</dt>
<dd><p class="first">Returns following objects:</p>
<p>for a surface it returns an array of shapes.</p>
<p>for a group it returns an object with a member variable children, which contains an array of shapes.</p>
<p class="last">for a shape it returns an object with a member variable shape, which contains a shape definition object.</p>
</dd>
</dl>
<p>Both a Shape and a Group may contain following member variables:</p>
<blockquote>
<dl class="docutils">
<dt>transform</dt>
<dd>Contains a transformation matrix.</dd>
<dt>stroke</dt>
<dd>Contains a stroke definition object.</dd>
<dt>fill</dt>
<dd>Contains a fill definition object.</dd>
<dt>font</dt>
<dd>Contains a font definition for text-based objects.</dd>
</dl>
</blockquote>
<p>Serialization helpers can be used to implement a persistent storage of vector-based images, generation of them on the server, conversion of dojox.gfx-based pictures in other formats (e.g., to PDF), and conversion of other formats (e.g., raw SVG) to dojox.gfx.</p>
<p>You can find examples in dojox/gfx/demos/creator.html and dojox/gfx/demos/inspector.html. Many serialized examples can be found in</p>
<div class="highlight-python"><pre>dojox/gfx/demos/data/*.json.</pre>
</div>
</div>
<div class="section" id="decompose-js">
<h3><a class="toc-backref" href="#id42">decompose.js<a class="headerlink" href="#decompose-js" title="Permalink to this headline">Â¶</a></a></h3>
<p>Some graphics libraries/renderers do not implement generic linear 2D transformations. They patronize developers with a &quot;simple&quot; subset, which typically include translation, rotation, and scaling operations. It makes next to impossible implementing compound transformations using the &quot;sandwich&quot; technique described above, storing transformations externally, or pre-calculating complex transformation ahead of time to improve the performance.</p>
<p>At present time only Canvas is on this dishonorable list. While the latest Canvas specification finally defined the transform() method, which essentially operates on 2D matrices, nobody implemented it yet, so we are left to implement the general 2D matrix algebra on top of childish primitives. Is it possible? You bet! Of course at comes at a price of reduced performance, which is O.K. in most cases.</p>
<p>dojox.gfx implements a decomposition of any reasonable linear 2D transformation into four-component &quot;primitive&quot; transformations applied in succession. It is done using the singular value decomposition and the eigendecomposition, so you don't have to do it yourself.</p>
<p>This algorithm is used internally in the Canvas renderer, but you are welcomed to use it for your own needs.</p>
<dl class="docutils">
<dt>decompose(matrix)</dt>
<dd>Takes a matrix in any suitable form and returns an object with 6 member variables:</dd>
<dt>dx, dy</dt>
<dd>Define the translation component.</dd>
<dt>sx, sy</dt>
<dd>Define the scaling/mirroring component.</dd>
<dt>angle1</dt>
<dd>Defines the first rotation.</dd>
<dt>angle2</dt>
<dd>Defines the second rotation.</dd>
</dl>
<p>Using these values the input matrix can be represented as a suporposition of &quot;primitive&quot; transformations: [translate(dx, dy), rotate(angle2), scale(sx, sy), rotate(angle1)].</p>
</div>
<div class="section" id="arc-js">
<h3><a class="toc-backref" href="#id43">arc.js<a class="headerlink" href="#arc-js" title="Permalink to this headline">Â¶</a></a></h3>
<p>Some graphics libraries/renderers do not implement generic elliptic arcs or even ellipses (variant: they do but transforming them reveals multiple bugs in the underlying implementation). Both VML and Canvas are on this dishonorable list. The simplest way to deal with it is to approximate them with simple cubic BÃ©zier curves - the Swiss-army knife of vector geometric shapes.
This algorithm is used internally, but you are welcomed to use it for you own needs.</p>
<dl class="docutils">
<dt>unitArcAsBezier(alpha)</dt>
<dd><p class="first">Returns an arc approximation as an object of 4 coordinates:</p>
<dl class="last docutils">
<dt>s</dt>
<dd>The start coordinate of the curve.</dd>
<dt>c1</dt>
<dd>The first control point of the curve.</dd>
<dt>c2</dt>
<dd>The second control point of the curve.</dd>
<dt>e</dt>
<dd>The end coordinate of the curve.</dd>
</dl>
</dd>
</dl>
<p>The resulting curve approximates an arc of 2 * angle size with radius of 1 symmetric around the x axis.
It is important to keep the angle value reasonably low to improve the precision of the approximation.
Angles less than PI/2 (45 degrees) are virtually indistinguishable from true arcs for typical screen sizes.</p>
<dl class="docutils">
<dt>curvePI4</dt>
<dd>A pre-calculated curve for the arc of PI/4 size. Essentially curvePI4 = unitArcAsBezier(PI/8).</dd>
<dt>arcAsBezier(last, rx, ry, xRotg, large, sweep, x, y)</dt>
<dd>Takes all parameters of the SVG elliptic arc and returns an array of cubic BÃ©zier curves necessary to represent the arc.</dd>
</dl>
<p>Each cubic arc is represented as an array of six numeric values: [c1.x, c1.y, c2.x, c2.y, e.x, e.y],
where c1 is the first control point, c2 is the second control point, and e is the end point. All values are absolute.</p>
</div>
</div>
<div class="section" id="considerations-and-caveats">
<h2><a class="toc-backref" href="#id44">Considerations and Caveats<a class="headerlink" href="#considerations-and-caveats" title="Permalink to this headline">Â¶</a></a></h2>
<p>The GFX system uses a series of underlying renderers for whichever browser loads the API. The renderer is determined at load time, and defines the entire API using whatever the browser is capable of: Silverlight or VML in IE, SVG in iPhone, Firefox and Safari, and a light-weight canvas variant are available.</p>
<p>To define specifically which renderers can be used, and their relative priority, set the 'gfxRenderer' value in djConfig as a comma delimited string value, e.g. to specify that only SVG, Silverlight and VML should be used, and not Canvas, use:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;dojo/dojo.js&quot;</span> <span class="na">djConfig=</span><span class="s">&quot;parseOnLoad:true,gfxRenderer:&#39;svg,silverlight,vml&#39;&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>
</div>
<p>In the example above SVG will be tried first, if it fails Silverlight will be tried, and the last one will be VML.</p>
<p><strong>It is important to note:</strong> there isn't currently a way to include all the required renderers in a single file (such as a layer created by a custom Dojo Build). Not only would the size be prohibitive, each of the renderers re-defining the API would cause severe errors.</p>
</div>
<div class="section" id="demos">
<h2><a class="toc-backref" href="#id45">Demos<a class="headerlink" href="#demos" title="Permalink to this headline">Â¶</a></a></h2>
<p>Demos are relatively complex examples located in the demos/ sub-directory. They are used to make sure that all parts of dojox.gfx work together well, to assess the performance, and to give realistic examples to users:</p>
<dl class="docutils">
<dt>demos/butterfly.html, demos/lion.html, demos/tiger.html</dt>
<dd>Show classic SVG pictures converted from the original SVG to dojox.gfx calls. You can rotate and scale them.</dd>
<dt>demos/circles.html</dt>
<dd>Shows 100 translucent draggable circles. It is a good example of dojox.gfx.move in action.</dd>
<dt>demos/clock.html, demos/clock_black.html</dt>
<dd>Show an animated analog clock. You can grab its hands and set your own time.
It is a good example on simple animation and an interaction with user's actions.</dd>
<dt>demos/creator.html, demos/inspector.html, demos/beautify.html</dt>
<dd>Implement simple persistence mechanism using dojox.gfx.utils, and simple interaction using dojox.gfx.move.</dd>
</dl>
</div>
<div class="section" id="tests">
<h2><a class="toc-backref" href="#id46">Tests<a class="headerlink" href="#tests" title="Permalink to this headline">Â¶</a></a></h2>
<p>All tests are located in the tests/ sub-directory.
They are used by developers to test the conformance, and can be used by users to see how different objects and algorithms can be used.
The following tests are available:</p>
<dl class="docutils">
<dt>runTests.html</dt>
<dd>Runs automated tests for the matrix (defined in tests/matrix.js) and the matrix decomposition (defined in tests/decompose.js).</dd>
<dt>test_arc.html</dt>
<dd>Tests elliptic arcs component in the path shape.</dd>
<dt>test_bezier.html</dt>
<dd>Tests the approximation of the elliptic arc with BÃ©zier curves helping to find potential problems with both arcs and curves.</dd>
<dt>test_decompose.html</dt>
<dd>A testbed for manual verification of the matrix decomposition.</dd>
<dt>test_fill.html</dt>
<dd>Tests the even-odd rule for fills.</dd>
<dt>test_gfx.html</dt>
<dd>A complex test, which tries to tests many things at once.</dd>
<dt>test_gradient.html</dt>
<dd>Tests gradients with transparency.</dd>
<dt>test_group.html</dt>
<dd>Tests how moving a shape between groups with different transformations affect the visual.</dd>
<dt>test_image1.html</dt>
<dd>Tests transformations applied to an image.</dd>
<dt>test_image2.html</dt>
<dd>Tests the particular case of transformation when an image is a part of a group.</dd>
<dt>test_linearGradient.html</dt>
<dd>Tests complex liner gradient fills.</dd>
<dt>test_linestyle.html</dt>
<dd>Tests all line styles.</dd>
<dt>test_pattern.html</dt>
<dd>Tests the pattern fill.</dd>
<dt>test_poly.html</dt>
<dd>Tests the line shape and the polyline shape by animating them using a rotation matrix and a timer.</dd>
<dt>test_resize.html</dt>
<dd>Tests the dynamic surface resizing.</dd>
<dt>test_setPath.html</dt>
<dd>Tests relative/absolute coordinates in the path definition using cubic and quadratic curves.</dd>
<dt>test_tbbox.html</dt>
<dd>Tests the getTransformBoundingBox() method.</dd>
<dt>test_text.html</dt>
<dd>Tests the text shape with various settings.</dd>
<dt>test_textpath.html</dt>
<dd>Tests the text path shape.</dd>
<dt>test_transform.html</dt>
<dd>Tests the transformation applied to groups and individual shapes.</dd>
</dl>
</div>
<div class="section" id="todo">
<h2><a class="toc-backref" href="#id47">TODO<a class="headerlink" href="#todo" title="Permalink to this headline">Â¶</a></a></h2>
<p>Temporary list of new subpages:</p>
<ul class="simple">
<li><a class="reference" href="gfx/matrix-tutorial.html#dojox-gfx-matrix-tutorial"><em>Matrix tutorial</em></a></li>
<li><a class="reference" href="gfx-visual-properties.html#dojox-gfx-visual-properties"><em>Visual properties</em></a></li>
<li><a class="reference" href="gfx-geometric-properties.html#dojox-gfx-geometric-properties"><em>Geometric properties</em></a></li>
</ul>
</div>
</div>


		      </div>
		    </div>
		  </div>
		  <div class="clearfix"></div>
	</div>
      </div>
	</div>
      <div class="clearer"></div>
    </div>
<div id="footer">
    
    <div class="footer">
      &copy; Copyright 2009, Dojo Foundation.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.1.
    </div>
</div>
<script type="text/javascript">
	document.body.className = "nihilo";
</script>
<script type="text/javascript">
    dojo.require("docs.widget.CodeViewer");
    dojo.require("docs.widget.CompoundViewer");
</script>
<!--
    <div class="footer">
      &copy; Copyright 2009, Dojo Foundation.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.1.
    </div>-->

  </body>
</html>