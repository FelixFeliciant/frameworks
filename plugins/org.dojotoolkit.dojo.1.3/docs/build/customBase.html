<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>build customBase &mdash; Dojo Toolkit v1.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="Dojo Toolkit v1.3.0 documentation" href="../index.html" />
    <link rel="up" title="Dojo Build" href="contents.html" />
    <link rel="next" title="Sample Directory Layout for Builds" href="directoryLayout.html" />
    <link rel="prev" title="build system build script (build.sh or build.bat)" href="buildScript.html" />
<script type="text/javascript">
	var djConfig = {
		parseOnLoad:true, 
		isDebug: false
	}
</script>
<script type="text/javascript" src="../_static/dojo/dojo/dojo.js"></script>
<style type="text/css">
@import "../_static/dojo/dijit/themes/dijit.css";
@import "../_static/dojo/dijit/themes/nihilo/nihilo.css";
@import "../_static/dojo/docs/widget/resources/CodeViewer.css";
@import "../_static/css/layout.css";
</style>

  </head>
  <body>  

    <div class="document">
	<div id="container">
      <div id="header">
	<div class="container">
		<div id="navHeader">
		  <ul>
		    <li><a href="../index.html">home</a> |</li>
            <li style="margin-right: 10px">
		      <a href="directoryLayout.html" title="Sample Directory Layout for Builds"
			 accesskey="N">next</a></li>
            <li >
		      <a href="buildScript.html" title="build system build script (build.sh or build.bat)"
			 accesskey="P">previous</a> |</li>
		    <li><a href="../contents.html">Dojo Toolkit v1.3.0 documentation</a> &raquo;</li>
		      <li><a href="contents.html" accesskey="U">Dojo Build</a> &raquo;</li> 
		  </ul>
		</div>
		<div id="searchHeader">
		    <div class="searchContainer">
		        <form class="search" action="../search.html" method="get">
                    <input class="textInput" type="text" name="q" size="18" />
                    <input class="buttonInput" type="submit" value="Go" />
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                </form>
		    </div>
		</div>
	</div>
      </div>
      <div class="content">
	<div id="content">
		  <div id="contentRight">
			  
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../contents.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference" href="">build customBase</a><ul>
<li><a class="reference" href="#introduction">Introduction</a></li>
<li><a class="reference" href="#dojo-require-for-base-functions">dojo.require for base functions</a></li>
<li><a class="reference" href="#usage">Usage</a></li>
<li><a class="reference" href="#including-specific-resources">Including Specific Resources</a></li>
<li><a class="reference" href="#caveats">Caveats</a></li>
<li><a class="reference" href="#known-bugs">Known Bugs</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="buildScript.html"
                                  title="previous chapter">build system build script (build.sh or build.bat)</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="directoryLayout.html"
                                  title="next chapter">Sample Directory Layout for Builds</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/build/customBase.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
        </div>
      </div>
		  </div>
		  <div id="contentLeft">
		    <div class="bodywrapper">
		      <div class="body">
			
  <div class="section" id="build-custombase">
<span id="id1"></span><h1><a class="toc-backref" href="#id2">build customBase<a class="headerlink" href="#build-custombase" title="Permalink to this headline">¶</a></a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Draft</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">1.0</td>
</tr>
<tr class="field"><th class="field-name">Project owner:</th><td class="field-body">(docs) Scott Jenkins</td>
</tr>
<tr class="field"><th class="field-name">Available:</th><td class="field-body">since V?</td>
</tr>
</tbody>
</table>
<div class="contents topic">
<p class="topic-title first"><a id="contents" name="contents">Contents</a></p>
<ul class="simple">
<li><a class="reference" href="#build-custombase" id="id2" name="id2">build customBase</a><ul>
<li><a class="reference" href="#introduction" id="id3" name="id3">Introduction</a></li>
<li><a class="reference" href="#dojo-require-for-base-functions" id="id4" name="id4">dojo.require for base functions</a></li>
<li><a class="reference" href="#usage" id="id5" name="id5">Usage</a></li>
<li><a class="reference" href="#including-specific-resources" id="id6" name="id6">Including Specific Resources</a></li>
<li><a class="reference" href="#caveats" id="id7" name="id7">Caveats</a></li>
<li><a class="reference" href="#known-bugs" id="id8" name="id8">Known Bugs</a></li>
</ul>
</li>
</ul>
</div>
<p>Custom base is used to make an extremely small file size version of dojo.js.</p>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id3">Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></a></h2>
<p>Normally, when the builder system creates <tt class="docutils literal"><span class="pre">dojo.js</span></tt> it includes the entire base set of Dojo APIs (almost everything that can be accessed directly in the <tt class="docutils literal"><span class="pre">dojo</span></tt> namespace).  This provides a robust and usable core functionality in a file that is approximately 76.7 KB uncompressed and 26.5K gzipped as of Dojo 1.2.3.</p>
<p>However, in some cases, such as creating web applications intended for use on smart phones, you may desire to create an even smaller <tt class="docutils literal"><span class="pre">dojo.js</span></tt>.  Using <tt class="docutils literal"><span class="pre">customBase</span></tt> you can achieve minimal Dojo versions as small as approximately 6k (including the stubs described below).</p>
<p>This is a very advanced feature, and if you think you need to use it, you should think carefully first. If after careful consideration, you still want to use this feature, be very, very careful and document it thoroughly for your own understanding.</p>
</div>
<div class="section" id="dojo-require-for-base-functions">
<h2><a class="toc-backref" href="#id4">dojo.require for base functions<a class="headerlink" href="#dojo-require-for-base-functions" title="Permalink to this headline">¶</a></a></h2>
<p>When you use the <tt class="docutils literal"><span class="pre">customBase</span></tt> option, some base Dojo functions are not copied into your <tt class="docutils literal"><span class="pre">dojo.js</span></tt> file, in order to reduce the file size.</p>
<p>Instead, a <tt class="docutils literal"><span class="pre">dojo.require</span></tt> statement is generated for each base resource that the builder identifies as being used in your module.  This identification is done with regular expression matching, and is by design somewhat lax to ensure it catches all resources that are needed.</p>
<p>This allows you to still use the entire base API, but at the cost of additional an additional round trip to the server <em>at the time a function not in base is first called</em>.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id5">Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></a></h2>
<p>In the profile for your build, specify the following for your dojo layer (note the <tt class="docutils literal"><span class="pre">customBase</span></tt> property):</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></td><td class="code"><div class="highlight"><pre><span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
  <span class="p">{</span>
       <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;dojo.js&quot;</span><span class="o">,</span>
       <span class="nx">customBase</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span>
       <span class="nx">dependencies</span><span class="o">:</span> <span class="p">[</span>
       <span class="p">]</span>
  <span class="p">}</span><span class="o">,</span>

 <span class="c">// ... remainder of profile</span>

 <span class="p">]</span>
</pre></div>
</td></tr></table></div>
<p>If, as shown in this example, you specify <tt class="docutils literal"><span class="pre">customBase:</span> <span class="pre">true</span></tt>, but do not specify any dependencies
for the <tt class="docutils literal"><span class="pre">dojo.js</span></tt> layer, then then <em>none</em> of <tt class="docutils literal"><span class="pre">dojo._base</span></tt> gets added to
<tt class="docutils literal"><span class="pre">dojo.js</span></tt>.</p>
<p>You just end up with the following from <tt class="docutils literal"><span class="pre">dojo/_base/_loader</span></tt>, basically, just bare utilities for browser detection:</p>
<blockquote>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojo.addOnLoad</span></tt></li>
<li><tt class="docutils literal"><span class="pre">addOnUnload</span></tt></li>
<li><tt class="docutils literal"><span class="pre">dojo.require</span></tt></li>
<li><tt class="docutils literal"><span class="pre">dojo.provide</span></tt></li>
<li><tt class="docutils literal"><span class="pre">bootstrap.js</span></tt></li>
<li><tt class="docutils literal"><span class="pre">hostenv_browser.js</span></tt></li>
<li><tt class="docutils literal"><span class="pre">loader.js</span></tt></li>
</ul>
</blockquote>
</div>
<div class="section" id="including-specific-resources">
<h2><a class="toc-backref" href="#id6">Including Specific Resources<a class="headerlink" href="#including-specific-resources" title="Permalink to this headline">¶</a></a></h2>
<p>To include specific dojo base resources in your minimal build, use the dependencies list for the dojo.js layer.</p>
<p>For example, if you specify <tt class="docutils literal"><span class="pre">customBase:</span> <span class="pre">true</span></tt>, but want a particular <tt class="docutils literal"><span class="pre">dojo/_base</span></tt>
module, say just the array help functions and <tt class="docutils literal"><span class="pre">dojo.Deferred</span></tt>, your profile <tt class="docutils literal"><span class="pre">dojo.js</span></tt> layer would
look like this:</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8</pre></td><td class="code"><div class="highlight"><pre>  <span class="p">{</span>
         <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;dojo.js&quot;</span><span class="o">,</span>
         <span class="nx">customBase</span><span class="o">:</span> <span class="kc">true</span>
         <span class="nx">dependencies</span><span class="o">:</span> <span class="p">[</span>
                 <span class="s2">&quot;dojo._base.Deferred&quot;</span><span class="o">,</span>
                 <span class="s2">&quot;dojo._base.array&quot;</span>
         <span class="p">]</span>
  <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="caveats">
<h2><a class="toc-backref" href="#id7">Caveats<a class="headerlink" href="#caveats" title="Permalink to this headline">¶</a></a></h2>
<p>If you use <tt class="docutils literal"><span class="pre">customBase:</span> <span class="pre">true</span></tt>, then the build system will use
regular expressions to see if any of the modules in the build (dojo, dijit, dojox,
your custom namespaces) use any <tt class="docutils literal"><span class="pre">dojo._base</span> <span class="pre">methods</span></tt>, and if they detect
a usage, it will inject <tt class="docutils literal"><span class="pre">dojo.require</span></tt> calls into the built modules.</p>
<p>This helps avoid issues where you use a module that needs a <tt class="docutils literal"><span class="pre">dojo._base</span></tt>
module that you did not include in your <tt class="docutils literal"><span class="pre">dojo.js</span></tt>. However since it is
using regular expressions, you may get more <tt class="docutils literal"><span class="pre">dojo.require</span></tt> calls for <tt class="docutils literal"><span class="pre">dojo._base</span></tt>
modules than necessary. The idea was to have the detection be very lax
in what it matches to avoid run time errors.</p>
<p>Example: if the build
finds &quot;indexOf&quot; in the module, it will add in a
<tt class="docutils literal"><span class="pre">dojo.require(&quot;dojo._base.array&quot;)</span></tt>, but that <tt class="docutils literal"><span class="pre">indexOf</span></tt> in the module could
have been a String method call.</p>
</div>
<div class="section" id="known-bugs">
<h2><a class="toc-backref" href="#id8">Known Bugs<a class="headerlink" href="#known-bugs" title="Permalink to this headline">¶</a></a></h2>
<p><tt class="docutils literal"><span class="pre">customBase:</span> <span class="pre">true</span></tt> should not be used with <tt class="docutils literal"><span class="pre">djConfig.require</span></tt>. There is a
bug where the <tt class="docutils literal"><span class="pre">djConfig.require</span></tt> will not be included correctly
depending on if you leave out <tt class="docutils literal"><span class="pre">dojo._base.browser</span></tt>:
<a class="reference" href="http://bugs.dojotoolkit.org/ticket/7756">http://bugs.dojotoolkit.org/ticket/7756</a></p>
</div>
</div>


		      </div>
		    </div>
		  </div>
		  <div class="clearfix"></div>
	</div>
      </div>
	</div>
      <div class="clearer"></div>
    </div>
<div id="footer">
    
    <div class="footer">
      &copy; Copyright 2009, Dojo Foundation.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.1.
    </div>
</div>
<script type="text/javascript">
	document.body.className = "nihilo";
</script>
<script type="text/javascript">
    dojo.require("docs.widget.CodeViewer");
    dojo.require("docs.widget.CompoundViewer");
</script>
<!--
    <div class="footer">
      &copy; Copyright 2009, Dojo Foundation.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.1.
    </div>-->

  </body>
</html>